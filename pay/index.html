<!DOCTYPE html>
<html>
<head>
  <!--<script src="deeplink.js"></script>-->
</head>
<body>
  <div id="root">
    this is test for web-payment api
  </div>
  <script>
    //deeplink.createBrowser();
    Notification.requestPermission().then((permission) => {
      console.log(permission);
    }).catch((error) => {
      console.log(error);
    });
    
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.getRegistrations().then((registrations) => {
        for(var i in registrations) {
          console.log(JSON.stringify(registrations[i])  + "in registrations");
          registrations[i].unregister().then((success) => {
            console.log("unregister success!");
          }).catch((error) => {
            console.log("unregister failed!");
          });
        }
      })
      navigator.serviceWorker.register('sw.js', {scope: './pay'}).then((registration) => {
        registration.update().then((success) => {
          alert('service_registration update!');
          console.log("update success!" + success);
        }).catch((error) => {
          console.log("update failed! " + error);
        });
      });
      alert('serviceWorker.registered success!');
    } else {
      alert('serviceWorker.registered failed!'); 
    }  
  </script>
</body>
</html>
